<%- include('./partials/header') %>
<script src="/javascripts/moduleFunctions.js" defer></script>
<div id="module-container">
  <div id="module-info">
    <div id="module-info-left">
      <h2>Topic: <%= module.topic%></h2>
      <div>
        <p><span>Category:</span> <%= module.category.name%></p>
        <p><span>Material From:</span> <%= module.source%></p>
      </div>
      <div>
        <button id = "quiz-btn" >Quiz</button>
        <button id = "gn-btn" >Guided Notes</button>
      </div>
    </div>
    <div id="module-info-right">
      <p>Created by: <%= module.creator.name%></p>
      <p><%= module.dateCreated.toDateString()%></p>
      <div>
        <%if(user && user.id==module.creator._id){%>
          <a href="/modules/edit/<%= module._id%>">Edit</a>
        <form
        id="<%= module._id%>"
        method="POST"
        action="/modules/delete/<%= module._id%>/?_method=DELETE"
      ><a href=# class="deleteBtn">Delete</a>
      </form>
        <%}%>
      </div>
    </div>
  </div>
  <div id="fib-container">
    <div id="quiz-container">
      <h4>Quiz</h4>
    <% if(!feedback){ %>
    <form method="POST" action ="/modules/<%= module._id%>/check">
    <%}else{%>
    <div>
    <%}%>
      <ol>
        <% module.fibStats.forEach(function(sentence, index){ let newSen =
        sentence.replace(/\(-.+-\)/, "___________");%>
        <li>
          <p><%= newSen %></p>
        </li>
        <div>
          <p>Enter your answer here:</p>
          <input name = "<%= index %>" 
          <%if(feedback){%> value="<%= feedback[index+1].answer%>" 
          class = "<%= (feedback[index+1].status) %>" <%}%> type="text" />
        </div>
        <% })%>
      </ol>
      <div id="submit-container">
        <% if(!feedback){ %>
          <input type="submit" />
        <%}else{%>
          <a href="/modules/<%= module._id%>"><button>Try Again</button></a>
        <%}%>
      </div>
    <% if(!feedback){ %>
    </form >
    <%}else{%>
    </div>
    <%}%>
    </div>
    <div id="gn-container">
      <h4>Guided Notes</h4>
      <p>
        <% module.guidedNotes.split(" ").forEach(function(word, index){
        if(word.match(/\(-.+-\)/)){%>
        <input id='<%=word.replace(/\(-+|-\)+/g, "")%>' type="text" />
        <%}else{%> <%=word%> <%}})%>
      </p>
    </div>
  </div>
  <div id="pop-up-delete">
    <p>Are you sure you want to delete this module?</p>
    <div>
      <button id="del-yes">Yes</button>
      <button id="del-no">No</button>
    </div>
  </div>
  <div id="delete-backdrop"></div>
</div>
<%- include('./partials/footer') %>
